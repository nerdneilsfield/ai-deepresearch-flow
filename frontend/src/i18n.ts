import { createI18n } from 'vue-i18n'

const messages = {
  en: {
    appTitle: 'Paper DB',
    searchPlaceholder: 'Search papers, authors, venues...',
    // Navigation
    papers: 'Papers',
    stats: 'Stats',
    selected: 'Selected ({count})',
    download: 'Download ({count})',
    menu: 'Menu',
    // Search
    sort: 'Sort by',
    pageSize: 'Page size',
    facetFilter: 'Facet filter:',
    clear: 'Clear',
    resources: 'Resources',
    select: 'Select',
    selectedState: 'Selected',
    loading: 'Loading...',
    showingResults: 'Showing {start} to {end} of {total} results',
    prev: 'Prev',
    next: 'Next',
    facetBrowser: 'Facet Browser',
    filterFacet: 'Filter facet values...',
    selectFacet: 'Select facet',
    topAuthors: 'Top authors',
    topKeywords: 'Top keywords',
    topVenues: 'Top venues',
    topInstitutions: 'Top institutions',
    pageInfo: 'Page {page} / {total}',
    total: 'Total',
    // Stats
    backToSearch: 'Back to search',
    chartsNote: 'Charts are rendered with ECharts.',
    pubYear: 'Publication Year',
    pubMonth: 'Publication Month',
    keywords: 'Keywords',
    authors: 'Authors',
    venues: 'Venues',
    institutions: 'Institutions',
    years: 'Years',
    months: 'Months',
    count: 'Count',
    // Facet Stats
    facet: 'Facet',
    overview: 'Overview',
    totalPapers: 'Total papers',
    noData: 'No data',
    showMore: 'Show more',
    collapse: 'Collapse',
    browsePapers: 'Browse Papers',
    coAuthors: 'Co-authors',
    outputLang: 'Output Languages',
    promptTemplate: 'Prompt Templates',
    translationLang: 'Translation Languages',
    providers: 'Providers',
    models: 'Models',
    viewStats: 'View Stats',
    shareTip: 'Tip: You can share this URL — search state is synced to the query string.',
    help: 'Help',
    // Help Page
    helpTitle: 'How to use Paper DB',
    helpIntro: 'Paper DB is a research assistant for browsing and analyzing academic papers.',
    helpSearchTitle: 'Powerful Search',
    helpSearchDesc: 'Use the search bar to find papers by title, author, or content. Filters are automatically synced to the URL, making it easy to share specific search results with others.',
    helpSelectedTitle: 'Reading Queue (Selected)',
    helpSelectedDesc: 'Add papers to your "Selected" list to build a temporary reading queue. You can navigate through this queue in the detail view or download all selected papers as a ZIP package containing PDFs and Markdown summaries.',
    helpZenTitle: 'Zen Mode',
    helpZenDesc: 'Click "Zen Mode" in the paper detail view for a distraction-free reading experience that hides all navigation elements and maximizes the content area.',
    // Selected
    selectedTitle: 'Selected Papers',
    readingQueue: 'Reading queue and batch download',
    saveList: 'Save List',
    loadList: 'Load List',
    downloadZip: 'Download ZIP',
    preparing: 'Preparing...',
    downloaded: 'Downloaded',
    noPapers: 'No papers selected',
    noPapersDesc: 'Go to the search page to add papers to your reading list, or load a previously saved list.',
    // Sort
    relevance: 'Relevance',
    yearDesc: 'Year (new → old)',
    yearAsc: 'Year (old → new)',
    titleAsc: 'Title (A → Z)',
    titleDesc: 'Title (Z → A)',
    venueAsc: 'Venue (A → Z)',
    venueDesc: 'Venue (Z → A)',
    // Detail
    summary: 'Summary',
    markdown: 'Markdown',
    pdfViewer: 'PDF Viewer',
    split: 'Split',
    zenMode: 'Zen Mode',
    exitZenMode: 'Exit Zen Mode',
    hideMetadata: 'Hide metadata',
    showMetadata: 'Show metadata',
    view: 'View',
    queue: 'Queue',
    prevPaper: 'Previous in selection',
    nextPaper: 'Next in selection',
    metadata: 'Metadata',
    openPdf: 'Open PDF in new tab',
    summaryTemplate: 'Summary Template',
    viewTemplateStats: 'View template stats',
    source: 'Source',
    translated: 'Translated',
    abstract: 'Abstract',
    loadingPaperDetail: 'Loading paper detail...',
    // SearchResultItem
    selected_btn: 'Selected',
    selectionLimitReached: 'Selection limit reached',
    collapseSummary: 'Collapse summary',
    expandSummary: 'Expand summary',
    // Offline
    offlineNotice: 'You are offline. Some data may be unavailable.',
    // Facet select items
    summaryTemplates: 'Summary Templates',
    outputLanguages: 'Output Languages',
    promptTemplates: 'Prompt Templates',
    translationLanguages: 'Translation Languages',
    // SummaryPanel
    available: 'Available',
    authorsLabel: 'Authors',
    institutionsLabel: 'Institutions',
    outputLanguageLabel: 'Output Language',
    publicationDateLabel: 'Publication Date',
    venueLabel: 'Publication Venue',
    keywordsLabel: 'Keywords',
    abstractLabel: 'Abstract',
    // DOI & BibTeX
    doi: 'DOI',
    bibtex: 'BibTeX',
    copyBibtex: 'Copy BibTeX',
    copiedBibtex: 'Copied!',
    loadingBibtex: 'Loading BibTeX...',
    noBibtex: 'No BibTeX available',
    // PaperDetailView split
    left: 'Left',
    right: 'Right',
    width: 'Width',
    // Theme
    themeLight: 'Light',
    themeDark: 'Dark',
    themeSystem: 'System',
  },
  zh: {
    appTitle: '论文库',
    searchPlaceholder: '搜索论文、作者、期刊...',
    // Navigation
    papers: '论文',
    stats: '统计',
    selected: '已选 ({count})',
    download: '下载 ({count})',
    menu: '菜单',
    // Search
    sort: '排序',
    pageSize: '每页显示',
    facetFilter: '筛选:',
    clear: '清除',
    resources: '资源',
    select: '选择',
    selectedState: '已选',
    loading: '加载中...',
    showingResults: '显示第 {start} 至 {end} 项结果，共 {total} 项',
    prev: '上一页',
    next: '下一页',
    facetBrowser: '分类浏览',
    filterFacet: '筛选分类...',
    selectFacet: '选择分类',
    topAuthors: '热门作者',
    topKeywords: '热门关键词',
    topVenues: '热门期刊',
    topInstitutions: '热门机构',
    pageInfo: '第 {page} 页 / 共 {total} 页',
    total: '总计',
    // Stats
    backToSearch: '返回搜索',
    chartsNote: '图表由 ECharts 渲染',
    pubYear: '发表年份',
    pubMonth: '发表月份',
    keywords: '关键词',
    authors: '作者',
    venues: '期刊/会议',
    institutions: '机构',
    years: '年份',
    months: '月份',
    count: '数量',
    // Facet Stats
    facet: '分类',
    overview: '概览',
    totalPapers: '论文总数',
    noData: '无数据',
    showMore: '显示更多',
    collapse: '收起',
    browsePapers: '浏览论文',
    coAuthors: '合作者',
    outputLang: '输出语言',
    promptTemplate: '提示词模板',
    translationLang: '翻译语言',
    providers: '模型厂商',
    models: '模型',
    viewStats: '查看统计',
    shareTip: '提示：您可以直接分享当前 URL — 搜索状态已自动同步至查询参数。',
    help: '帮助',
    // Help Page
    helpTitle: '如何使用论文库',
    helpIntro: '论文库是一个用于浏览和分析学术论文的研究助手。',
    helpSearchTitle: '强大的搜索功能',
    helpSearchDesc: '使用搜索栏通过标题、作者或内容查找论文。筛选器会自动同步到 URL，方便与他人分享特定的搜索结果。',
    helpSelectedTitle: '阅读队列 (已选)',
    helpSelectedDesc: '将论文添加到“已选”列表以构建临时阅读队列。您可以在详情页中快速切换队列，或将所有选中论文下载为包含 PDF 和 Markdown 摘要的 ZIP 包。',
    helpZenTitle: '禅模式',
    helpZenDesc: '在论文详情页点击“禅模式”，即可享受无干扰的阅读体验，该模式会隐藏所有导航元素并最大化内容区域。',
    // Selected
    selectedTitle: '已选论文',
    readingQueue: '阅读队列与批量下载',
    saveList: '保存列表',
    loadList: '加载列表',
    downloadZip: '下载 ZIP',
    preparing: '准备中...',
    downloaded: '已下载',
    noPapers: '暂无选择',
    noPapersDesc: '前往搜索页添加论文到阅读列表，或加载之前保存的列表。',
    // Sort
    relevance: '相关度',
    yearDesc: '年份 (新 → 旧)',
    yearAsc: '年份 (旧 → 新)',
    titleAsc: '标题 (A → Z)',
    titleDesc: '标题 (Z → A)',
    venueAsc: '期刊/会议 (A → Z)',
    venueDesc: '期刊/会议 (Z → A)',
    // Detail
    summary: '摘要',
    markdown: 'Markdown',
    pdfViewer: 'PDF 阅读器',
    split: '分屏',
    zenMode: '禅模式',
    exitZenMode: '退出禅模式',
    hideMetadata: '隐藏元数据',
    showMetadata: '显示元数据',
    view: '视图',
    queue: '队列',
    prevPaper: '上一篇',
    nextPaper: '下一篇',
    metadata: '元数据',
    openPdf: '新标签页打开 PDF',
    summaryTemplate: '摘要模板',
    viewTemplateStats: '查看模板统计',
    source: '原文',
    translated: '翻译',
    abstract: '摘要 (Abstract)',
    loadingPaperDetail: '正在加载论文详情...',
    // SearchResultItem
    selected_btn: '已选',
    selectionLimitReached: '已达选择上限',
    collapseSummary: '收起摘要',
    expandSummary: '展开摘要',
    // Offline
    offlineNotice: '当前处于离线状态，部分数据可能不可用。',
    // Facet select items
    summaryTemplates: '摘要模板',
    outputLanguages: '输出语言',
    promptTemplates: '提示词模板',
    translationLanguages: '翻译语言',
    // SummaryPanel
    available: '可用',
    authorsLabel: '作者',
    institutionsLabel: '单位',
    outputLanguageLabel: '输出语言',
    publicationDateLabel: '发表日期',
    venueLabel: '期刊/会议',
    keywordsLabel: '关键词',
    abstractLabel: '摘要',
    // DOI & BibTeX
    doi: 'DOI',
    bibtex: 'BibTeX',
    copyBibtex: '复制 BibTeX',
    copiedBibtex: '已复制!',
    loadingBibtex: '加载 BibTeX 中...',
    noBibtex: '暂无 BibTeX',
    // PaperDetailView split
    left: '左侧',
    right: '右侧',
    width: '宽度',
    // Theme
    themeLight: '浅色',
    themeDark: '深色',
    themeSystem: '系统',
  },
}

function detectLocale() {
  const url = new URL(window.location.href)
  const langOverride = url.searchParams.get('lang')
  if (langOverride) return langOverride
  const stored = window.localStorage.getItem('paperdb_lang')
  if (stored) return stored
  const nav = navigator.language || 'en'
  return nav.toLowerCase().startsWith('zh') ? 'zh' : 'en'
}

const i18n = createI18n({
  legacy: false,
  locale: detectLocale(),
  fallbackLocale: 'en',
  messages,
})

export function setLocale(locale: string) {
  i18n.global.locale.value = locale as 'en' | 'zh'
  window.localStorage.setItem('paperdb_lang', locale)
}

export default i18n
