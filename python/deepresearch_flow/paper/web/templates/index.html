{% extends "base.html" %}

{% block extra_head %}
<style>
  #content img {
    max-width: 100%;
    height: auto;
  }
</style>
{% endblock %}

{% block content %}
<h2>Paper Database</h2>
<div class="card">
  <div class="muted">Search (Scholar-style): <code>tag:fpga year:2023..2025 -survey</code> Â· Use quotes for phrases and <code>OR</code> for alternatives.</div>
  <div class="search-row">
    <input id="query" placeholder='Search... e.g. title:"nearest neighbor" tag:fpga year:2023..2025' />
    <select id="openView">
      <option value="summary" selected>Open: Summary</option>
      <option value="source">Open: Source</option>
      <option value="translated">Open: Translated</option>
      <option value="pdf">Open: PDF</option>
      <option value="pdfjs">Open: PDF Viewer</option>
      <option value="split">Open: Split</option>
    </select>
  </div>
  <div class="filters" style="margin-top:10px;">
    <div class="filter-group">
      <label>PDF</label>
      <select id="filterPdf" multiple size="2">
        <option value="with">With</option>
        <option value="without">Without</option>
      </select>
    </div>
    <div class="filter-group">
      <label>Source</label>
      <select id="filterSource" multiple size="2">
        <option value="with">With</option>
        <option value="without">Without</option>
      </select>
    </div>
    <div class="filter-group">
      <label>Translated</label>
      <select id="filterTranslated" multiple size="2">
        <option value="with">With</option>
        <option value="without">Without</option>
      </select>
    </div>
    <div class="filter-group">
      <label>Summary</label>
      <select id="filterSummary" multiple size="2">
        <option value="with">With</option>
        <option value="without">Without</option>
      </select>
    </div>
    <div class="filter-group">
      <label>Template</label>
      <select id="filterTemplate" multiple size="4">
        {% if template_tags %}
        {% for tag in template_tags %}
        <option value="{{ tag }}">{{ tag }}</option>
        {% endfor %}
        {% else %}
        <option value="" disabled>(no templates)</option>
        {% endif %}
      </select>
    </div>
  </div>
  <div class="filter-row">
    <input id="filterQuery" placeholder='Filters... e.g. pdf:yes tmpl:simple' />
    <select id="sortBy">
      <option value="" selected>Sort: Default</option>
      <option value="year">Sort: Year</option>
      <option value="title">Sort: Title</option>
      <option value="venue">Sort: Venue</option>
      <option value="author">Sort: First Author</option>
    </select>
    <select id="sortDir">
      <option value="desc" selected>Order: Desc</option>
      <option value="asc">Order: Asc</option>
    </select>
    <span class="help-icon" data-tip="{{ filter_help | replace('\n', '&#10;') | safe }}">?</span>
  </div>
  <details style="margin-top:10px;">
    <summary>Advanced search</summary>
    <div style="margin-top:10px;" class="muted">Build a query:</div>
    <div class="filters">
      <input id="advTitle" placeholder="title contains..." />
      <input id="advAuthor" placeholder="author contains..." />
      <input id="advTag" placeholder="tag (comma separated)" />
      <input id="advYear" placeholder="year (e.g. 2020..2024)" />
      <input id="advMonth" placeholder="month (01-12)" />
      <input id="advVenue" placeholder="venue contains..." />
    </div>
    <div class="adv-actions">
      <button id="buildQuery" style="padding:8px 12px; border-radius:8px; border:1px solid #d0d7de; background:#f6f8fa; cursor:pointer;">Build</button>
      <div class="muted">Generated: <code id="generated"></code></div>
    </div>
  </details>
</div>
<div id="stats" class="stats">
  <div id="statsTotal" class="stats-row"></div>
  <div id="statsFiltered" class="stats-row" style="margin-top:6px;"></div>
</div>
<div id="results"></div>
<div id="loading" class="muted">Loading...</div>
{% endblock %}

{% block extra_scripts %}
<script src="/static/js/index.js"></script>
{% endblock %}
